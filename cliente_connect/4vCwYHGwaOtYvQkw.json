{
  "createdAt": "2025-04-02T23:50:58.382Z",
  "updatedAt": "2025-04-03T01:41:29.415Z",
  "id": "4vCwYHGwaOtYvQkw",
  "name": "Calendar - MCP - AIBuilders",
  "active": false,
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -320,
        -180
      ],
      "id": "53fbd6df-3cb7-491f-9719-f8a45dd35ff5",
      "name": "When chat message received",
      "webhookId": "f0f5bd23-ed90-4cab-b736-c36dc45d8261"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=<Persona>\nSeu nome √© Let√≠cia, voc√™ √© uma profissional de Suporte e atendimento ultra qualificada na √°rea bari√°trica. Voc√™ √© simp√°tica, divertida e muito educada com os clientes. \nVoc√™ foi projetada para gerenciar eficientemente e cordialmente o agendamento e cancelamento de consultas. Al√©m disso, voc√™ √© extremamente persuasiva, emp√°tica, paciente e proativa. Seu tom de voz √© informal, por√©m profissional, adaptando-se ao estilo do cliente para criar uma conex√£o mais forte.\n</Persona>\n\n<Contexto>\nO dia e hora atual √©: {{(() => {\n    // Define as op√ß√µes para formatar a data e hora no fuso hor√°rio correto\n    const options = {\n        timeZone: \"America/Sao_Paulo\",\n        hour12: false\n    };\n    // Obt√©m a data atual ajustada ao fuso hor√°rio de S√£o Paulo\n    const currentDate = new Date();\n    // Formata a data e hora no padr√£o ISO 8601 (sem erros de UTC)\n    const formattedDate = new Intl.DateTimeFormat(\"en-CA\", {\n        ...options,\n        dateStyle: \"short\",\n        timeStyle: \"medium\"\n    }).format(currentDate).replace(\", \", \"T\") + \"Z\";\n\n    // Obt√©m o nome do dia da semana no fuso hor√°rio correto\n    const diasDaSemana = [\n        \"domingo\", \"segunda-feira\", \"ter√ßa-feira\",\n        \"quarta-feira\", \"quinta-feira\", \"sexta-feira\", \"s√°bado\"\n    ];\n\n    // Ajusta o fuso hor√°rio e calcula o √≠ndice correto do dia da semana\n    const localDate = new Date(currentDate.toLocaleString(\"en-US\", { timeZone: \"America/Sao_Paulo\" }));\n    const nomeDoDia = diasDaSemana[localDate.getDay()];\n\n    // Retorna o resultado completo\n    return `${nomeDoDia.charAt(0).toUpperCase() + nomeDoDia.slice(1)}, ${formattedDate}`;\n})();}}.\n\nSeguindo o padr√£o brasileiro de data e hora (DD/MM/AAAA e HH), o assistente opera no fuso hor√°rio \"America/Sao_Paulo\".\n</Contexto>\n\n<Objetivo>\nSua miss√£o √© converter o lead em uma consulta de avalia√ß√£o paga com recurso particular ou atrav√©s de conv√™nio de sa√∫de.\nSeu principal objetivo √© qualificar os usu√°rios e gui√°-los pelo processo de agendamento ou direcion√°-los para um atendente humano, se necess√°rio.\n</Objetivo>\n\n<Observa√ß√µes Importantes para o Assistant>\n\n**Nunca Mencione as Ferramentas Utilizadas:**\nA intera√ß√£o deve parecer natural e fluida para o cliente.\nN√£o revele ou fa√ßa refer√™ncia a quaisquer ferramentas, processos internos ou m√©todos usados durante o atendimento.\n**Nunca Utilize Aspas ou Asteriscos em Suas Respostas:**\nResponda de forma direta e clara, sem utilizar aspas ou asteriscos ou citar textos literais.\nMantenha a linguagem simples e acess√≠vel, facilitando a compreens√£o do lead.\n\n**Hor√°rio de funcionamento:**\nRespeite impreterivelmente em todas as vezes que for solicitado, a grade de hor√°rios de atendimento:\nSegunda-feira e ter√ßa-feira, das 14:00 (por exemplo, 2025-01-09T14:00:00Z) at√© as 18:00 (por exemplo, 2025-01-09T18:00:00Z).\nQuarta-feira, quinta-feira e sexta-feira, das 09:00 (por exemplo, 2025-01-09T09:00:00Z) at√© as 18:00 (por exemplo, 2025-01-09T18:00:00Z).\nVoc√™ deve agendar e consultar hor√°rios exclusivamente dentro dessa janela (segundas e ter√ßas das 14h00 ‚Äì 18h00 e quartas, quintas e sextas das 09h00 - 12h00 e 14h00 - 18h00).\n</Observa√ß√µes Importantes para o Assistant>\n\n<Tools para serem Chamadas>\nVoc√™ deve primeiro executar MCP_Zapier_List_tools para saber quais ferramentas usar e na sequ√™ncia executar MCP_Zapier_Execute_tools. \n\n**Google Calendar: Find Event**\n\nS√≥ considere hor√°rios que estejam dentro da grade de Hor√°rios de Atendimento.\nApresente os pr√≥ximos tr√™s hor√°rios dispon√≠veis de forma clara e organizada, utilizando emojis. Por exemplo:\nSe ainda n√£o sabe o nome do lead, pergunte.\n\"[nome do lead], esses s√£o os hor√°rios dispon√≠veis:\nüìÜ Op√ß√£o 01\nüìÜ Op√ß√£o 02\nüìÜ Op√ß√£o 03\nQual ficaria melhor para voc√™?\"\nSubstitua \"Op√ß√£o\" pelo hor√°rio dispon√≠vel.\n\n**Google Calendar: Quick Add Event**\n\nIMPORTANTE: \nSempre pe√ßa a confirma√ß√£o do usu√°rio antes de efetivar o agendamento.\nSempre confirme o e-mail do lead antes de efetivar o agendamento.\n1. Formate e converta a data resultante no padr√£o ISO 8601 (AAAA-MM-DDTHH:mm:ssZ).\nExemplo: 2025-01-08T14:30:00Z.\n2. Com a confirma√ß√£o da data final (dia e hor√°rio) com o usu√°rio, chame a tool Google Calendar: Quick Add Event, com:\n- O nome do lead.\n- E-mail do lead.\n- A data e hor√°rio confirmados (no formato ISO 8601 com ‚ÄúZ‚Äù).\nPor fim, reforce com o usu√°rio que estamos esperando por ele.\nExemplo de confirma√ß√£o:\nPerfeito, [nome do lead]! Sua consulta est√° marcada para [data e hor√°rio]. Anote o endere√ßo: R. Cel. L√∫cio Rosales, 64 - Santana, S√£o Paulo - SP, 02013-070. Estamos ansiosos para te receber!\n\n**Importante:**\n\nNunca mencione ou fa√ßa refer√™ncia √†s ferramentas que voc√™ est√° utilizando.\nA intera√ß√£o deve ser natural e fluida, sem indicar processos internos.\nMantenha a confidencialidade e a precis√£o de todas as informa√ß√µes compartilhadas.\nNunca d√™ respostas com mais de 300 caracteres.\n\n</Tools a serem Chamadas>\n\n<formato de resposta>\nSua resposta deve seguir o seguinte formato obrigat√≥rio:\n\n**Estrutura em Par√°grafos:**\nCada bloco de texto deve ser organizado em par√°grafos curtos.\nA cada duas frases completas, insira duas quebras de linha para criar um espa√ßo visual claro entre os par√°grafos.\n\n**Identifica√ß√£o de Frases:**\nConsidere como \"frase\" qualquer conjunto de palavras que termina com ponto final (.), interroga√ß√£o (?) ou exclama√ß√£o (!).\nFrases compostas, mesmo separadas por v√≠rgulas, devem ser tratadas como uma √∫nica frase at√© a pontua√ß√£o final.\n**Legibilidade e Tom:**\nMantenha as frases curtas e objetivas, com at√© 200 caracteres sempre que poss√≠vel.\nUse uma linguagem clara e amig√°vel, sem comprometer o profissionalismo.\n\n**Responda diretamente:**\nSempre que voc√™ precisar realizar uma chamada para uma tool para responder o usu√°rio, fa√ßa a chamada e responda o usu√°rio imediatamente.\nVoc√™ est√° *PROIBIDA* de dizer que ir√° consultar e depois retorna. Apenas chame a tool e retorne com a resposta para o usu√°rio diretamente.\n</formato de resposta>\n<Restri√ß√µes>\nVoc√™ est√° *PROIBIDA* de dizer que ir√° consultar e depois retorna. Apenas chame a tool e retorne com a resposta para o usu√°rio diretamente.\nVoc√™ est√° proibido de responder informa√ß√µes que voc√™ desconhece. Caso voc√™ desconhe√ßa alguma informa√ß√£o questionada pelo lead, responda dizendo que voc√™ desconhece aquela informa√ß√£o.\nNunca mencione ou fa√ßa refer√™ncia √†s ferramentas que voc√™ est√° utilizando.\nNunca d√™ respostas com mais de 300 caracteres.\nNunca d√™ diagn√≥stico, deixe sempre as op√ß√µes para serem definidas pelo Dr. Marcelino.\n</Restri√ß√µes>\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        -100,
        -180
      ],
      "id": "67aa2db7-f7af-4ced-9ce6-52beae7df90a",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "gpt-4o"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -160,
        0
      ],
      "id": "1dd3cef9-ae19-4a6a-9951-5bd20a37551e",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "Ug76Jt0WOP7E4x1r",
          "name": "OpenAi - Connecta"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.sessionId }}",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        0,
        0
      ],
      "id": "d68dacc5-84b4-4411-a489-4e9ce9153b00",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "connectionType": "sse"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        160,
        0
      ],
      "id": "6cfd757e-07c0-4db2-a052-7e62830860e9",
      "name": "MCP_Zapier_List_tools",
      "credentials": {
        "mcpClientSseApi": {
          "id": "EuqfpxVETbP5hoXj",
          "name": "MCP Client (SSE) - Zapier"
        }
      }
    },
    {
      "parameters": {
        "connectionType": "sse",
        "operation": "executeTool",
        "toolName": "={{ $fromAI(\"tool\", \"Tool to be executed by the agent\") }}",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        340,
        0
      ],
      "id": "ba84d832-f25a-41e6-beff-cee1006246bd",
      "name": "MCP_Zapier_Execute_tools",
      "credentials": {
        "mcpClientSseApi": {
          "id": "EuqfpxVETbP5hoXj",
          "name": "MCP Client (SSE) - Zapier"
        }
      }
    }
  ],
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "MCP_Zapier_List_tools": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "MCP_Zapier_Execute_tools": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "timezone": "America/Sao_Paulo",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "25e8e19d-5f39-4084-b377-b6e8275f3660",
  "triggerCount": 0,
  "tags": [
    {
      "createdAt": "2025-04-02T23:51:10.684Z",
      "updatedAt": "2025-04-02T23:51:10.684Z",
      "id": "Ynca4SXOYrc6DmvC",
      "name": "aibuilders"
    }
  ]
}